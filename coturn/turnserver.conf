# MuMu Camera TURN Server Configuration
# Based on Coturn

# Listening port for TURN (default: 3478)
listening-port=3478

# TLS listening port (for TURNS)
# tls-listening-port=5349

# Listening IP (0.0.0.0 for all interfaces)
listening-ip=0.0.0.0

# External IP address (set this to your public IP in production)
# This is crucial for NAT traversal
# external-ip=YOUR.PUBLIC.IP.ADDRESS

# Relay IP (internal IP to relay from)
relay-ip=0.0.0.0

# Min and max port for relay endpoints
# Reduced range for Windows compatibility (100 ports should be enough for testing)
min-port=49152
max-port=49252

# Verbose logging (disable in production)
verbose

# Enable fingerprints in TURN messages
fingerprint

# Use time-limited credentials (REST API mode)
# This is what we use with dynamic credentials from backend
# NOTE: Do NOT use lt-cred-mech with use-auth-secret
use-auth-secret
static-auth-secret=mumucam_turn_secret_key_change_in_production

# Realm for TURN server
realm=mumucam

# Total quota (in MB) for each user
user-quota=0
total-quota=0

# Server name
server-name=mumucam-turn

# Disable UDP relay (uncomment to force TCP only)
# no-udp-relay

# Disable TCP relay (uncomment to force UDP only)
# no-tcp-relay

# Enable STUN
# STUN is always enabled by default

# Deny all peers by default, allow specific ranges if needed
# no-multicast-peers

# Disable loopback peers
no-loopback-peers

# Disable RFC5780 (NAT behavior discovery)
# Reduces TURN server load
# stun-only

# Enable Prometheus metrics (if coturn compiled with support)
# prometheus

# Log file (use stdout for Docker)
# log-file=/var/log/turnserver.log
log-file=stdout

# PID file
pidfile=/var/run/turnserver.pid

# Run as user (for security, if not in Docker)
# proc-user=turnserver
# proc-group=turnserver

# SSL/TLS configuration (for TURNS)
# cert=/etc/coturn/cert.pem
# pkey=/etc/coturn/privkey.pem

# Cipher list for TLS
# cipher-list="ECDHE-RSA-AES256-GCM-SHA512:DHE-RSA-AES256-GCM-SHA512:ECDHE-RSA-AES256-GCM-SHA384:DHE-RSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-SHA384"

# DH parameters file (for TLS)
# dh2066

# Enable mobility (ICE Mobility)
# mobility

# Ban private IP ranges (security)
no-cli
cli-password=mumucam_cli_password

# Database for persistent storage (optional)
# For production, consider using Redis or PostgreSQL
# userdb=/var/db/turndb
# psql-userdb=host=localhost dbname=turn user=turn password=turn connect_timeout=30

# Redis support (if needed for distributed TURN servers)
# redis-userdb="ip=127.0.0.1 dbname=0 password=turn connect_timeout=30"

# Bandwidth limitation (bytes per second, 0 = unlimited)
# max-bps=0

# Deny connection from banned IPs
# denied-peer-ip=192.168.1.0-192.168.1.255

# Allow connection only from specific IPs
# allowed-peer-ip=10.0.0.0-10.255.255.255
